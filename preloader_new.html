<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="styles/preloader.css" />
</head>
<body>
<style>
    body{
        background-color: black;
    }
    .row1{
        background-color: rgba(13, 39, 10, 0.82);
    }
    .row2{
        background-color: #3f0104;
    }
    .row3{
        background-color: #00043b;
    }
</style>

<div id="cursor">
    <div class="under" id="cube"></div>
    <div class="over nudge_left" id="up"></div>
    <div class="over nudge_left" id="backup"></div>
    <div class="over nudge_left" id="down"></div>
    <div class="over nudge_left" id="backdown"></div>
    <div class="over nudge_left nudge_down" id="ex"></div>
    <div class="over nudge_down" id="backex"></div>
    <div class="over margin-top-ghost" id="menu"></div>
    <!--<div class="over" id="backmenu"></div>-->
</div>

<span id="preloaderwrapper">
    <span class="progress" id="progress"></span>
    <span id="mask-outer" class="mask"></span>
    <span id="loader-fill2" class="always"></span>
    <span id="loader-fill" class="some"></span>
    <span id="mask-inner" class="mask"></span>
</span>

<div class="my-row row1"></div>
<div class="my-row row2"></div>
<div class="my-row row3"></div>


<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/progressbar.js/dist/progressbar.js"></script>
<script type="text/javascript" src="js/jquery.lazylinepainter-1.7.0.min.js"></script>

<script>
    $(document).ready(function() {
        var $windowHeight = window.innerHeight;
        var $section = $windowHeight/3;
        var currentEvent;


        //CURSORS
        var $cursor = $('#cursor');
        var $cube = $('#cube');
        var $up = $('#up');
        var $backup = $('#backup');
        var $down = $('#down');
        var $backdown = $('#backdown');
        var $menu = $('#menu');
        var $ex = $('#ex');
        var $backex = $('#backex');

        //STATES
        var hasPreLoaded = false;
        var isUp = false;
        var isDown = false;
        var isMenuButton = false;
        var isNavOpen = false;
        var isAnimating = false;
        var hasClicked = false;
        var comingFromX = false;
        var beenMenu = false;

        //CURSOR DRAWING INFO
        var svgDatacube= {
            "cube": {
                "strokepath": [
                    //2
                    {
                        "path": "M 50.4 59.8 L 50.4 1.8",
                        "duration": 600
                    },
                    //10
                    {
                        "path": "M 50.4 59.8 L 99.2 88.4",
                        "duration": 600
                    },
                    //8
                    {
                        "path": "M 50.4 59.8 L 1.6 88.4",
                        "duration": 600
                    },
                    //5
                    {
                        "path": "M 50.4 59.8 L 1.6 30.4",
                        "duration": 600
                    },
                    //6
                    {
                        "path": "M 50.4 59 L 99.2 30.4",
                        "duration": 600
                    },
                    //9
                    {
                        "path": "M 50.4 59.8 L 50.4 116.8",
                        "duration": 600
                    },





                    //7
                    {
                        "path": "M 99.2 30.4 L 99.2 88.4",
                        "duration": 600,
                        "delay":600

                    },
                    //4
                    {
                        "path": "M 1.6 30.4 L 1.6 88.4",
                        "duration": 600,
                        "delay":600
                    },


                    //3
                    {
                        "path": "M 50.4 1.8 L 99.2 30.4",
                        "duration": 600,
                        "delay":1200
                    },

                    //1
                    {
                        "path": "M 50.4 1.8 L 1.6 30.4",
                        "duration": 600,
                        "delay":1200
                    },
                    //11
                    {
                        "path": "M 50.4 117 L 1.6 88.4",
                        "duration": 600,
                        "delay":1200
                    },
                    //12
                    {
                        "path": "M 50.4 117 L 99.2 88.4",
                        "duration": 600,
                        "delay":1200
                    },



                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataUp= {
            "up": {
                "strokepath": [
                    //2
                    {
                        "path": "M 50.4 59.8 L 50.4 1.8",
                        "duration": 600
                    },
                    //3
                    {
                        "path": "M 50.4 1.8 L 99.2 30.4",
                        "duration": 600,
                        "delay":600
                    },
                    //1
                    {
                        "path": "M 50.4 1.8 L 1.6 30.4",
                        "duration": 600,
                        "delay":600
                    },
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataBackUp= {
            "backup": {
                "strokepath": [
                    //2
                    {
                        "path": "M 50.4 1.8 L 50.4  59.8",
                        "duration": 600,
                        "delay":600
                    },
                    //3
                    {
                        "path": "M 99.2 30.4 L 50.4 1.8",
                        "duration": 600
                    },
                    //1
                    {
                        "path": "M 1.6 30.4 L 50.4 1.8",
                        "duration": 600
                    }
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataDown= {
            "down": {
                "strokepath": [
                    //9
                    {
                        "path": "M 50.4 59.8 L 50.4 116.8",
                        "duration": 600
                    },
                    //11
                    {
                        "path": "M 50.4 117 L 1.6 88.4",
                        "duration": 600,
                        "delay":600
                    },
                    //12
                    {
                        "path": "M 50.4 117 L 99.2 88.4",
                        "duration": 600,
                        "delay":600
                    },
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataBackDown= {
            "backdown": {
                "strokepath": [
                    //11
                    {
                        "path": "M 1.6 88.4 L 50.4 117",
                        "duration": 600
                    },
                    //12
                    {
                        "path": "M 99.2 88.4 L 50.4 117",
                        "duration": 600
                    },
                    //9
                    {
                        "path": "M 50.4 116.8 L 50.4 59.8",
                        "duration": 600,
                        "delay":600
                    }
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataMenu= {
            "menu": {
                "strokepath": [
                    //3
                    {
                        "path": "M 50.4 1.8 L 99.2 30.4",
                        "duration": 600
                    },
                    //1
                    {
                        "path": "M 50.4 1.8 L 1.6 30.4",
                        "duration": 600
                    },
                    //11
                    {
                        "path": "M 50.4 117 L 1.6 88.4",
                        "duration": 600
                    },
                    //12
                    {
                        "path": "M 50.4 117 L 99.2 88.4",
                        "duration": 600
                    },
                    //5
                    {
                        "path": "M 50.4 59.8 L 1.6 30.4",
                        "duration": 600,
                        "delay":450
                    },
                    //10
                    {
                        "path": "M 50.4 59.8 L 99.2 88.4",
                        "duration": 600,
                        "delay":450
                    },
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataEx= {
            "ex": {
                "strokepath": [
                    //10
                    {
                        "path": "M 50.4 59.8 L 99.2 88.4",
                        "duration": 600
                    },
                    //8
                    {
                        "path": "M 50.4 59.8 L 1.6 88.4",
                        "duration": 600
                    },
                    //5
                    {
                        "path": "M 50.4 59.8 L 1.6 30.4",
                        "duration": 600
                    },
                    //6
                    {
                        "path": "M 50.4 59 L 99.2 30.4",
                        "duration": 600
                    },
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };
        var svgDataBackEx= {
            "backex": {
                "strokepath": [
                    //10
                    {
                        "path": "M 99.2 88.4 L 50.4 59.8",
                        "duration": 600
                    },
                    //8
                    {
                        "path": "M 1.6 88.4 L 50.4 59.8",
                        "duration": 600
                    },
                    //5
                    {
                        "path": "M 1.6 30.4 L 50.4 59.8",
                        "duration": 600
                    },
                    //6
                    {
                        "path": "M 99.2 30.4 L 50.4 59",
                        "duration": 600
                    },
                ],
                "dimensions": {
                    "width": 101,
                    "height": 120
                }
            }
        };

        //PRELOADER
        var circle = new ProgressBar.Circle('#progress', {
            color: '#ffffff',
            duration: 3000,
            easing: 'easeInOut',
            strokeWidth: 30
        });
        var cirCount =0;
        var imgArray = [];
        var $maskInner =$('#mask-inner');
        var $loaderFill1 =$('#loader-fill');
        var $loaderFill2 =$('#loader-fill2');
        var $preloaderWrapper=$('#preloaderwrapper');

        imgArray = ['http://fok.local/assets/1.png'];
        $maskInner.hide();
        $loaderFill2[0].style.display = "none";
        $loaderFill1[0].style.display = "none";

        //CURSOR SETUP
        $cube.lazylinepainter({
            'svgData': svgDatacube,
            'strokeWidth': 2,
            'strokeColor': 'grey',
            'drawSequential': false,
            'ease': 'easeInOutQuad'
        });
        $up.lazylinepainter({
            'svgData': svgDataUp,
            'strokeWidth': 2,
            'strokeColor': '#2de9a1',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true},
            'onStrokeComplete': function(){isUp = true;isAnimating = false;}
        });
        $backup.lazylinepainter({
            'svgData': svgDataBackUp,
            'strokeWidth': 2,
            'strokeColor': 'grey',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true},
            'onStrokeComplete': function(){isUp = false;isAnimating = false;}
        });
        $down.lazylinepainter({
            'svgData': svgDataDown,
            'strokeWidth': 2,
            'strokeColor': '#2de9a1',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true},
            'onStrokeComplete': function(){isDown = true;isAnimating = false;}
        });
        $backdown.lazylinepainter({
            'svgData': svgDataBackDown,
            'strokeWidth': 2,
            'strokeColor': 'grey',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true},
            'onStrokeComplete': function(){isDown = false;isAnimating = false;}
        });
        $menu.lazylinepainter({
            'svgData': svgDataMenu,
            'strokeWidth': 2,
            'strokeColor': '#2de9a1',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true},
            'onStrokeComplete':function(){isAnimating = false;}
        });
        $ex.lazylinepainter({
            'svgData': svgDataEx,
            'strokeWidth': 2,
            'strokeColor': '#2de9a1',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true;$ex.show();},
            'onStrokeComplete':function(){isAnimating = false;}
        });
        $backex.lazylinepainter({
            'svgData': svgDataBackEx,
            'strokeWidth': 2,
            'strokeColor': 'grey',
            'drawSequential': false,
            'ease': 'easeInOutQuad',
            'onStrokeStart': function(){isAnimating = true;},
            'onStrokeComplete': function(){document.getElementById("backex").style.visibility = "hidden";$ex.hide();isAnimating = false;}
        });

        //CURSOR FUNCTIONS
        function checkCursor(e){
            if(e.pageY == undefined){e = currentEvent;}else{
                currentEvent = e;
            }

            //check that the preloader is finished and that the cursor is currently animating
            if(hasPreLoaded && !isAnimating){
                //if in the top(menu) section
                if((e.pageY < $section)) {

                    //if the cursor is not already a menu button and the menu(nav) is not open
                    if(!isMenuButton && !isNavOpen){
                        showMenu();
                    }
                    if(comingFromX) {
                       hideUpandDown();
                    }
                }else{
                    if(isMenuButton && !isNavOpen){
                        hideMenu();
                    }
                }
//middle section
                if((e.pageY > $section)&&(e.pageY < $section*2)&& !isUp && !isMenuButton){

                    if(isMenuButton) {
                        isMenuButton = false;
                    }
                    showUp();
                    hideMenu();
                }
//bottom
                if((e.pageY > ($section*2))&& !isDown && !isMenuButton){

                    if(isMenuButton) {
                        isMenuButton = false;
                    }
                    showDown();
                    hideMenu()
                }

//                if(isMenuButton && !isNavOpen){
//                   $navigation.css({
//                       display:'block',
//                       left:  (e.pageX-14),
//                       top:   (e.pageY-8)
//                   });
//                } else if(!isNavOpen){
//                   $navigation.css({
//                       display:'none'
//                   });
//                }
            }
            comingFromX = false;
        }


        function hideAll(except){
            except = (typeof except === 'undefined') ? 'none' : except;

            $cube[0].style.visibility = "hidden";
            $up[0].style.visibility = "hidden";
            $backup[0].style.visibility = "hidden";
            $down[0].style.visibility = "hidden";
            $backdown[0].style.visibility = "hidden";
            $menu[0].style.visibility = "hidden";
            $ex[0].style.visibility = "hidden";
            $backex[0].style.visibility = "hidden";

            switch (except) {
                case "cube":
                    $cube[0].style.visibility = "visible";
                    break;
                case "up":
                    $up[0].style.visibility = "visible";
                    $backup[0].style.visibility = "visible";
                    break;
                case "down":
                    $down[0].style.visibility = "visible";
                    $backdown[0].style.visibility = "visible";
                    break;
                case "menu":
                    $menu[0].style.visibility = "visible";
                    break;
                case "ex":
                    $ex[0].style.visibility = "visible";
                   $backex[0].style.visibility = "visible";
                    break;
            }
        }



        function showCube(){
            $cube[0].style.visibility = "visible";
//            $up[0].style.visibility = "visible";
//            $backup[0].style.visibility = "visible";
//            $down[0].style.visibility = "visible";
//            $backdown[0].style.visibility = "visible";
            $menu[0].style.visibility = "visible";
//            $ex[0].style.visibility = "visible";
          //  checkCursor(currentEvent);

        }

        function showUp(){
            if(isDown) {
                hideDown();
            }
            $backup.hide();
            $up.lazylinepainter('paint');
        };
        function hideUp(){
            $backup.show();
            $backup.lazylinepainter('paint');
            isUp = false;
        };
        function showDown(){
            if(isUp) {
                hideUp();
            }
            $backdown.hide();
            $down.lazylinepainter('paint');
        };
        function hideDown(){
            $backdown.show();
            $backdown.lazylinepainter('paint');
            isDown = false;
        };
        function showMenu(){
            if(isUp) {
                hideUp();
            }else if(isDown){
                hideDown();
            }
            $menu.show();
            $menu.lazylinepainter('paint');
            $cube.addClass('menu');

            hideUpandDown();

            isMenuButton = true;

        };
        function hideMenu(setbool){
            setbool = (typeof setbool === 'undefined') ? false : setbool;
            $menu.hide();
            $up[0].style.visibility = "visible";
            $down[0].style.visibility = "visible";
            $backup[0].style.visibility = "visible";
            $backdown[0].style.visibility = "visible";

            $cube.removeClass('menu');
            $cube.addClass('nomenu');

            isMenuButton = setbool;
        };
        function showEx(){
            $backex[0].style.visibility = "hidden";
            $ex.lazylinepainter('paint');
            if(!beenMenu) {
                beenMenu = true;
                $menu.removeClass('margin-top-ghost');
            }
        };
        function hideEx(){
            $backex[0].style.visibility = "visible";
            $backex.lazylinepainter('paint');
            $cursor[0].style.opacity="0";
            showCube();
        };
        function hideUpandDown() {
            $up[0].style.visibility = "hidden";
            $down[0].style.visibility = "hidden";
            $backup[0].style.visibility = "hidden";
            $backdown[0].style.visibility = "hidden";
        };



        $(window).resize(function () {
            $windowHeight = window.innerHeight;
            $section = $windowHeight/3;
            $(".my-row").css('height', $section + 'px');
        });

        $(document).on('mousemove', function(e){
                $cursor.css({
                    left:  e.pageX,
                    top:   e.pageY
                });
                checkCursor(e);
        });

        $(document).on('click', function(e){
            if(!hasClicked){
                hasClicked = true;
                setTimeout(function(){
                    hasClicked = false;
                }, 500);
                if(isMenuButton){
                    if(!isNavOpen) {
                        $cursor.addClass('open');
//                    $navigation.addClass('open');
                        isNavOpen = true;

                        hideAll('ex');
                        showEx();


                    }else{

                        $cursor.removeClass('open');
                        isNavOpen = false;
                        comingFromX=true;
                        hideEx();
                        setTimeout(function(){
                            $cursor.animate({
                                opacity: 1,
                            },600);
                        }, 500);

                    }
                }
                if(isUp){
                    $.fn.fullpage.moveSectionUp();
                }
                if(isDown){
                    $.fn.fullpage.moveSectionDown();
                }
            }
        });

//    /*
//     *   preloader
//     *
//     */
        function hidePreloader() {
            $loaderFill2[0].style.display = "block";
            $loaderFill1[0].style.display = "block";
            $maskInner.show();
            $loaderFill1.removeClass('some');
            $loaderFill1.addClass('none');

            setTimeout(function(){
                $preloaderWrapper.animate({opacity:'0'},800);
            }, 1000);
        }

        function doneLoading() {
            hidePreloader();
            $cube.lazylinepainter('paint');
            $cursor.css({
                top: '50%',
                left: '50%',
                marginTop: '-25px',
                marginLeft: '-12px'
            });

            setTimeout(function(){
                $('html').css({cursor: 'none'});
                hasPreLoaded=true;
            }, 1000);

        }
        function preload(imgArray) {
            var increment = Math.floor(100 / imgArray.length);
            $(imgArray).each(function () {
                $('<img>').attr("src", this).load(function () {
                    if ((cirCount + increment) > cirCount) {
                        cirCount += increment;
                        circle.animate(cirCount / 100);
                    }
                });

            });
        }
        preload(imgArray);
        $(window).load(function() {
            loaded = true;
            circle.animate(1, function() {
                setTimeout(function(){
                    doneLoading();
                }, 1000);
            });
        });
        $(window).trigger('resize');
    });
</script>
</body>
</html>
